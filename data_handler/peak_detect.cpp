#include "peak_detect.h"

#include <QDebug>

#include "line_intersection.h"

PeakDetect::PeakDetect()
{
}

void PeakDetect::Test()
{
    QVector<QPointF> fam = {
        QPointF(40.9, -9.81052),
        QPointF(41, -10.7204),
        QPointF(41.1, -11.4808),
        QPointF(41.2, -12.1126),
        QPointF(41.3, -12.6882),
        QPointF(41.4, -13.2845),
        QPointF(41.5, -13.9398),
        QPointF(41.6, -14.6391),
        QPointF(41.7, -15.3313),
        QPointF(41.8, -15.9667),
        QPointF(41.9, -16.5307),
        QPointF(42, -17.0541),
        QPointF(42.1, -17.5953),
        QPointF(42.2, -18.2068),
        QPointF(42.3, -18.4042),
        QPointF(42.4, -18.3984),
        QPointF(42.5, -18.3154),
        QPointF(42.6, -18.2205),
        QPointF(42.7, -18.1447),
        QPointF(42.8, -18.1004),
        QPointF(42.9, -18.0819),
        QPointF(43, -18.0617),
        QPointF(43.1, -17.9977),
        QPointF(43.2, -17.855),
        QPointF(43.3, -17.6315),
        QPointF(43.4, -17.3635),
        QPointF(43.5, -17.1066),
        QPointF(43.6, -16.9041),
        QPointF(43.7, -16.7673),
        QPointF(43.8, -16.6774),
        QPointF(43.9, -16.6029),
        QPointF(44, -16.5212),
        QPointF(44.1, -16.4302),
        QPointF(44.2, -16.346),
        QPointF(44.3, -16.2877),
        QPointF(44.4, -16.261),
        QPointF(44.5, -16.2506),
        QPointF(44.6, -16.2253),
        QPointF(44.7, -16.1548),
        QPointF(44.8, -16.0275),
        QPointF(44.9, -15.86),
        QPointF(45, -15.6916),
        QPointF(45.1, -15.5662),
        QPointF(45.2, -15.5082),
        QPointF(45.3, -15.5078),
        QPointF(45.4, -15.5225),
        QPointF(45.5, -15.4974),
        QPointF(45.6, -15.3931),
        QPointF(45.7, -15.2069),
        QPointF(45.8, -14.9755),
        QPointF(45.9, -14.757),
        QPointF(46, -14.6028),
        QPointF(46.1, -14.5321),
        QPointF(46.2, -14.5239),
        QPointF(46.3, -14.5287),
        QPointF(46.4, -14.4934),
        QPointF(46.5, -14.3864),
        QPointF(46.6, -14.2094),
        QPointF(46.7, -13.9934),
        QPointF(46.8, -13.7802),
        QPointF(46.9, -13.6025),
        QPointF(47, -13.4714),
        QPointF(47.1, -13.3754),
        QPointF(47.2, -13.2913),
        QPointF(47.3, -13.1975),
        QPointF(47.4, -13.0846),
        QPointF(47.5, -12.9574),
        QPointF(47.6, -12.8291),
        QPointF(47.7, -12.7123),
        QPointF(47.8, -12.6122),
        QPointF(47.9, -12.5233),
        QPointF(48, -12.4335),
        QPointF(48.1, -12.33),
        QPointF(48.2, -12.2066),
        QPointF(48.3, -12.0672),
        QPointF(48.4, -11.9244),
        QPointF(48.5, -11.794),
        QPointF(48.6, -11.687),
        QPointF(48.7, -11.6039),
        QPointF(48.8, -11.5347),
        QPointF(48.9, -11.4646),
        QPointF(49, -11.3828),
        QPointF(49.1, -11.2894),
        QPointF(49.2, -11.1956),
        QPointF(49.3, -11.1174),
        QPointF(49.4, -11.0646),
        QPointF(49.5, -11.0331),
        QPointF(49.6, -11.0045),
        QPointF(49.7, -10.9546),
        QPointF(49.8, -10.8659),
        QPointF(49.9, -10.7366),
        QPointF(50, -10.5824),
        QPointF(50.1, -10.428),
        QPointF(50.2, -10.295),
        QPointF(50.3, -10.1918),
        QPointF(50.4, -10.1108),
        QPointF(50.5, -10.0355),
        QPointF(50.6, -9.94936),
        QPointF(50.7, -9.84405),
        QPointF(50.8, -9.72018),
        QPointF(50.9, -9.58337),
        QPointF(51, -9.43877),
        QPointF(51.1, -9.2885),
        QPointF(51.2, -9.13345),
        QPointF(51.3, -8.97758),
        QPointF(51.4, -8.83083),
        QPointF(51.5, -8.70732),
        QPointF(51.6, -8.61874),
        QPointF(51.7, -8.56652),
        QPointF(51.8, -8.53804),
        QPointF(51.9, -8.5102),
        QPointF(52, -8.45911),
        QPointF(52.1, -8.37092),
        QPointF(52.2, -8.24786),
        QPointF(52.3, -8.10625),
        QPointF(52.4, -7.96787),
        QPointF(52.5, -7.84908),
        QPointF(52.6, -7.7535),
        QPointF(52.7, -7.67146),
        QPointF(52.8, -7.58623),
        QPointF(52.9, -7.48329),
        QPointF(53, -7.35784),
        QPointF(53.1, -7.21691),
        QPointF(53.2, -7.07544),
        QPointF(53.3, -6.94875),
        QPointF(53.4, -6.84552),
        QPointF(53.5, -6.76466),
        QPointF(53.6, -6.69706),
        QPointF(53.7, -6.63077),
        QPointF(53.8, -6.55623),
        QPointF(53.9, -6.46901),
        QPointF(54, -6.3692),
        QPointF(54.1, -6.25889),
        QPointF(54.2, -6.13966),
        QPointF(54.3, -6.01172),
        QPointF(54.4, -5.87483),
        QPointF(54.5, -5.73027),
        QPointF(54.6, -5.58242),
        QPointF(54.7, -5.43898),
        QPointF(54.8, -5.309),
        QPointF(54.9, -5.1994),
        QPointF(55, -5.11144),
        QPointF(55.1, -5.03909),
        QPointF(55.2, -4.97073),
        QPointF(55.3, -4.89376),
        QPointF(55.4, -4.80016),
        QPointF(55.5, -4.69034),
        QPointF(55.6, -4.573),
        QPointF(55.7, -4.46109),
        QPointF(55.8, -4.36544),
        QPointF(55.9, -4.28921),
        QPointF(56, -4.22604),
        QPointF(56.1, -4.16306),
        QPointF(56.2, -4.08742),
        QPointF(56.3, -3.99294),
        QPointF(56.4, -3.88331),
        QPointF(56.5, -3.7698),
        QPointF(56.6, -3.66489),
        QPointF(56.7, -3.57548),
        QPointF(56.8, -3.49976),
        QPointF(56.9, -3.42935),
        QPointF(57, -3.35535),
        QPointF(57.1, -3.27427),
        QPointF(57.2, -3.19014),
        QPointF(57.3, -3.11152),
        QPointF(57.4, -3.04528),
        QPointF(57.5, -2.99126),
        QPointF(57.6, -2.94121),
        QPointF(57.7, -2.88292),
        QPointF(57.8, -2.80719),
        QPointF(57.9, -2.71335),
        QPointF(58, -2.61009),
        QPointF(58.1, -2.51068),
        QPointF(58.2, -2.42545),
        QPointF(58.3, -2.35569),
        QPointF(58.4, -2.29275),
        QPointF(58.5, -2.22298),
        QPointF(58.6, -2.13572),
        QPointF(58.7, -2.0298),
        QPointF(58.8, -1.91473),
        QPointF(58.9, -1.8058),
        QPointF(59, -1.71593),
        QPointF(59.1, -1.64872),
        QPointF(59.2, -1.59646),
        QPointF(59.3, -1.54416),
        QPointF(59.4, -1.47729),
        QPointF(59.5, -1.38911),
        QPointF(59.6, -1.2837),
        QPointF(59.7, -1.17306),
        QPointF(59.8, -1.07022),
        QPointF(59.9, -0.982087),
        QPointF(60, -0.90628),
        QPointF(60.1, -0.833415),
        QPointF(60.2, -0.753313),
        QPointF(60.3, -0.661358),
        QPointF(60.4, -0.561467),
        QPointF(60.5, -0.464219),
        QPointF(60.6, -0.381412),
        QPointF(60.7, -0.32007),
        QPointF(60.8, -0.279004),
        QPointF(60.9, -0.249549),
        QPointF(61, -0.219843),
        QPointF(61.1, -0.180206),
        QPointF(61.2, -0.126684),
        QPointF(61.3, -0.0610495),
        QPointF(61.4, 0.0122647),
        QPointF(61.5, 0.089976),
        QPointF(61.6, 0.171904),
        QPointF(61.7, 0.259895),
        QPointF(61.8, 0.354755),
        QPointF(61.9, 0.453692),
        QPointF(62, 0.550448),
        QPointF(62.1, 0.638432),
        QPointF(62.2, 0.714988),
        QPointF(62.3, 0.783902),
        QPointF(62.4, 0.854186),
        QPointF(62.5, 0.935392),
        QPointF(62.6, 1.03194),
        QPointF(62.7, 1.13979),
        QPointF(62.8, 1.24777),
        QPointF(62.9, 1.34335),
        QPointF(63, 1.42016),
        QPointF(63.1, 1.48304),
        QPointF(63.2, 1.54734),
        QPointF(63.3, 1.63216),
        QPointF(63.4, 1.7507),
        QPointF(63.5, 1.90281),
        QPointF(63.6, 2.07392),
        QPointF(63.7, 2.24115),
        QPointF(63.8, 2.38346),
        QPointF(63.9, 2.49082),
        QPointF(64, 2.56791),
        QPointF(64.1, 2.63075),
        QPointF(64.2, 2.69833),
        QPointF(64.3, 2.78355),
        QPointF(64.4, 2.88811),
        QPointF(64.5, 3.00367),
        QPointF(64.6, 3.11814),
        QPointF(64.7, 3.2233),
        QPointF(64.8, 3.3192),
        QPointF(64.9, 3.41342),
        QPointF(65, 3.51605),
        QPointF(65.1, 3.63382),
        QPointF(65.2, 3.76666),
        QPointF(65.3, 3.90819),
        QPointF(65.4, 4.04934),
        QPointF(65.5, 4.18262),
        QPointF(65.6, 4.30492),
        QPointF(65.7, 4.41789),
        QPointF(65.8, 4.52632),
        QPointF(65.9, 4.63605),
        QPointF(66, 4.75246),
        QPointF(66.1, 4.88004),
        QPointF(66.2, 5.02244),
        QPointF(66.3, 5.18224),
        QPointF(66.4, 5.36027),
        QPointF(66.5, 5.55458),
        QPointF(66.6, 5.76032),
        QPointF(66.7, 5.97098),
        QPointF(66.8, 6.18079),
        QPointF(66.9, 6.38714),
        QPointF(67, 6.59137),
        QPointF(67.1, 6.79754),
        QPointF(67.2, 7.00965),
        QPointF(67.3, 7.2289),
        QPointF(67.4, 7.45228),
        QPointF(67.5, 7.67318),
        QPointF(67.6, 7.88382),
        QPointF(67.7, 8.07842),
        QPointF(67.8, 8.25607),
        QPointF(67.9, 8.42184),
        QPointF(68, 8.5855),
        QPointF(68.1, 8.75765),
        QPointF(68.2, 8.94451),
        QPointF(68.3, 9.14369),
        QPointF(68.4, 9.34297),
        QPointF(68.5, 9.52354),
        QPointF(68.6, 9.66678),
        QPointF(68.7, 9.76191),
        QPointF(68.8, 9.81113),
        QPointF(68.9, 9.82934),
        QPointF(69, 9.83843),
        QPointF(69.1, 9.85815),
        QPointF(69.2, 9.89807),
        QPointF(69.3, 9.95422),
        QPointF(69.4, 10.012),
        QPointF(69.5, 10.0537),
        QPointF(69.6, 10.0671),
        QPointF(69.7, 10.0498),
        QPointF(69.8, 10.0093),
        QPointF(69.9, 9.95728),
        QPointF(70, 9.90365),
        QPointF(70.1, 9.85206),
        QPointF(70.2, 9.80018),
        QPointF(70.3, 9.74311),
        QPointF(70.4, 9.67759),
        QPointF(70.5, 9.60429),
        QPointF(70.6, 9.52691),
        QPointF(70.7, 9.44913),
        QPointF(70.8, 9.3719),
        QPointF(70.9, 9.29308),
        QPointF(71, 9.21009),
        QPointF(71.1, 9.12368),
        QPointF(71.2, 9.04023),
        QPointF(71.3, 8.97036),
        QPointF(71.4, 8.92379),
        QPointF(71.5, 8.90314),
        QPointF(71.6, 8.9001),
        QPointF(71.7, 8.89686),
        QPointF(71.8, 8.87289),
        QPointF(71.9, 8.81426),
        QPointF(72, 8.72087),
        QPointF(72.1, 8.60779),
        QPointF(72.2, 8.49948),
        QPointF(72.3, 8.41938),
        QPointF(72.4, 8.37964),
        QPointF(72.5, 8.37583),
        QPointF(72.6, 8.38889),
        QPointF(72.7, 8.39352),
        QPointF(72.8, 8.36923),
        QPointF(72.9, 8.30923),
        QPointF(73, 8.2235),
        QPointF(73.1, 8.13484),
        QPointF(73.2, 8.0697),
        QPointF(73.3, 8.04783),
        QPointF(73.4, 8.07508),
        QPointF(73.5, 8.1418),
        QPointF(73.6, 8.22705),
        QPointF(73.7, 8.30621),
        QPointF(73.8, 8.35898),
        QPointF(73.9, 8.37502),
        QPointF(74, 8.35585),
        QPointF(74.1, 8.31302),
        QPointF(74.2, 8.26362),
        QPointF(74.3, 8.22496),
        QPointF(74.4, 8.20991),
        QPointF(74.5, 8.22388),
        QPointF(74.6, 8.2639),
        QPointF(74.7, 8.31982),
        QPointF(74.8, 8.37742),
        QPointF(74.9, 8.42288),
        QPointF(75, 8.44724),
        QPointF(75.1, 8.4497),
        QPointF(75.2, 8.43816),
        QPointF(75.3, 8.42672),
        QPointF(75.4, 8.43058),
        QPointF(75.5, 8.46024),
        QPointF(75.6, 8.51725),
        QPointF(75.7, 8.59356),
        QPointF(75.8, 8.67469),
        QPointF(75.9, 8.74538),
        QPointF(76, 8.79528),
        QPointF(76.1, 8.82231),
        QPointF(76.2, 8.83283),
        QPointF(76.3, 8.83867),
        QPointF(76.4, 8.85286),
        QPointF(76.5, 8.88544),
        QPointF(76.6, 8.94108),
        QPointF(76.7, 9.01838),
        QPointF(76.8, 9.11078),
        QPointF(76.9, 9.20782),
        QPointF(77, 9.29671),
        QPointF(77.1, 9.36448),
        QPointF(77.2, 9.40103),
        QPointF(77.3, 9.40273),
        QPointF(77.4, 9.37544),
        QPointF(77.5, 9.33464),
        QPointF(77.6, 9.30175),
        QPointF(77.7, 9.29682),
        QPointF(77.8, 9.33026),
        QPointF(77.9, 9.39739),
        QPointF(78, 9.47871),
        QPointF(78.1, 9.54648),
        QPointF(78.2, 9.57538),
        QPointF(78.3, 9.5524),
        QPointF(78.4, 9.4818),
        QPointF(78.5, 9.38218),
        QPointF(78.6, 9.27709),
        QPointF(78.7, 9.18321),
        QPointF(78.8, 9.10214),
        QPointF(78.9, 9.0201),
        QPointF(79, 8.91591),
        QPointF(79.1, 8.77372),
        QPointF(79.2, 8.59425),
        QPointF(79.3, 8.39956),
        QPointF(79.4, 8.19341),
        QPointF(79.5, 7.99792),
        QPointF(79.6, 7.83),
        QPointF(79.7, 7.69499),
        QPointF(79.8, 7.58623),
        QPointF(79.9, 7.48978),
        QPointF(80, 7.39136),
        QPointF(80.1, 7.28203),
        QPointF(80.2, 7.16031),
        QPointF(80.3, 7.03045),
        QPointF(80.4, 6.89842),
        QPointF(80.5, 6.76817),
        QPointF(80.6, 6.64012),
    };

    PointSeq local_peaks = LocalPeaks(fam);
    qDebug() << local_peaks;
    PeakInfoSeq info_seq = LocalPeakInfo(fam, local_peaks);
    for (const auto&info:info_seq){
        info.second.DebugOutput();
    }
    PeakFilter filter(2, 0, 0, 0,5);
    PeakInfoSeq final = FiltPeaks(info_seq, filter);
    qDebug() << "filtered"<<final.size();
    for (const auto &p : final)
        p.second.DebugOutput();
}

void PeakDetect::testData()
{
    QVector<QPointF> fam = {
        QPointF(40.9, -9.81052),
        QPointF(41, -10.7204),
        QPointF(41.1, -11.4808),
        QPointF(41.2, -12.1126),
        QPointF(41.3, -12.6882),
        QPointF(41.4, -13.2845),
        QPointF(41.5, -13.9398),
        QPointF(41.6, -14.6391),
        QPointF(41.7, -15.3313),
        QPointF(41.8, -15.9667),
        QPointF(41.9, -16.5307),
        QPointF(42, -17.0541),
        QPointF(42.1, -17.5953),
        QPointF(42.2, -18.2068),
        QPointF(42.3, -18.4042),
        QPointF(42.4, -18.3984),
        QPointF(42.5, -18.3154),
        QPointF(42.6, -18.2205),
        QPointF(42.7, -18.1447),
        QPointF(42.8, -18.1004),
        QPointF(42.9, -18.0819),
        QPointF(43, -18.0617),
        QPointF(43.1, -17.9977),
        QPointF(43.2, -17.855),
        QPointF(43.3, -17.6315),
        QPointF(43.4, -17.3635),
        QPointF(43.5, -17.1066),
        QPointF(43.6, -16.9041),
        QPointF(43.7, -16.7673),
        QPointF(43.8, -16.6774),
        QPointF(43.9, -16.6029),
        QPointF(44, -16.5212),
        QPointF(44.1, -16.4302),
        QPointF(44.2, -16.346),
        QPointF(44.3, -16.2877),
        QPointF(44.4, -16.261),
        QPointF(44.5, -16.2506),
        QPointF(44.6, -16.2253),
        QPointF(44.7, -16.1548),
        QPointF(44.8, -16.0275),
        QPointF(44.9, -15.86),
        QPointF(45, -15.6916),
        QPointF(45.1, -15.5662),
        QPointF(45.2, -15.5082),
        QPointF(45.3, -15.5078),
        QPointF(45.4, -15.5225),
        QPointF(45.5, -15.4974),
        QPointF(45.6, -15.3931),
        QPointF(45.7, -15.2069),
        QPointF(45.8, -14.9755),
        QPointF(45.9, -14.757),
        QPointF(46, -14.6028),
        QPointF(46.1, -14.5321),
        QPointF(46.2, -14.5239),
        QPointF(46.3, -14.5287),
        QPointF(46.4, -14.4934),
        QPointF(46.5, -14.3864),
        QPointF(46.6, -14.2094),
        QPointF(46.7, -13.9934),
        QPointF(46.8, -13.7802),
        QPointF(46.9, -13.6025),
        QPointF(47, -13.4714),
        QPointF(47.1, -13.3754),
        QPointF(47.2, -13.2913),
        QPointF(47.3, -13.1975),
        QPointF(47.4, -13.0846),
        QPointF(47.5, -12.9574),
        QPointF(47.6, -12.8291),
        QPointF(47.7, -12.7123),
        QPointF(47.8, -12.6122),
        QPointF(47.9, -12.5233),
        QPointF(48, -12.4335),
        QPointF(48.1, -12.33),
        QPointF(48.2, -12.2066),
        QPointF(48.3, -12.0672),
        QPointF(48.4, -11.9244),
        QPointF(48.5, -11.794),
        QPointF(48.6, -11.687),
        QPointF(48.7, -11.6039),
        QPointF(48.8, -11.5347),
        QPointF(48.9, -11.4646),
        QPointF(49, -11.3828),
        QPointF(49.1, -11.2894),
        QPointF(49.2, -11.1956),
        QPointF(49.3, -11.1174),
        QPointF(49.4, -11.0646),
        QPointF(49.5, -11.0331),
        QPointF(49.6, -11.0045),
        QPointF(49.7, -10.9546),
        QPointF(49.8, -10.8659),
        QPointF(49.9, -10.7366),
        QPointF(50, -10.5824),
        QPointF(50.1, -10.428),
        QPointF(50.2, -10.295),
        QPointF(50.3, -10.1918),
        QPointF(50.4, -10.1108),
        QPointF(50.5, -10.0355),
        QPointF(50.6, -9.94936),
        QPointF(50.7, -9.84405),
        QPointF(50.8, -9.72018),
        QPointF(50.9, -9.58337),
        QPointF(51, -9.43877),
        QPointF(51.1, -9.2885),
        QPointF(51.2, -9.13345),
        QPointF(51.3, -8.97758),
        QPointF(51.4, -8.83083),
        QPointF(51.5, -8.70732),
        QPointF(51.6, -8.61874),
        QPointF(51.7, -8.56652),
        QPointF(51.8, -8.53804),
        QPointF(51.9, -8.5102),
        QPointF(52, -8.45911),
        QPointF(52.1, -8.37092),
        QPointF(52.2, -8.24786),
        QPointF(52.3, -8.10625),
        QPointF(52.4, -7.96787),
        QPointF(52.5, -7.84908),
        QPointF(52.6, -7.7535),
        QPointF(52.7, -7.67146),
        QPointF(52.8, -7.58623),
        QPointF(52.9, -7.48329),
        QPointF(53, -7.35784),
        QPointF(53.1, -7.21691),
        QPointF(53.2, -7.07544),
        QPointF(53.3, -6.94875),
        QPointF(53.4, -6.84552),
        QPointF(53.5, -6.76466),
        QPointF(53.6, -6.69706),
        QPointF(53.7, -6.63077),
        QPointF(53.8, -6.55623),
        QPointF(53.9, -6.46901),
        QPointF(54, -6.3692),
        QPointF(54.1, -6.25889),
        QPointF(54.2, -6.13966),
        QPointF(54.3, -6.01172),
        QPointF(54.4, -5.87483),
        QPointF(54.5, -5.73027),
        QPointF(54.6, -5.58242),
        QPointF(54.7, -5.43898),
        QPointF(54.8, -5.309),
        QPointF(54.9, -5.1994),
        QPointF(55, -5.11144),
        QPointF(55.1, -5.03909),
        QPointF(55.2, -4.97073),
        QPointF(55.3, -4.89376),
        QPointF(55.4, -4.80016),
        QPointF(55.5, -4.69034),
        QPointF(55.6, -4.573),
        QPointF(55.7, -4.46109),
        QPointF(55.8, -4.36544),
        QPointF(55.9, -4.28921),
        QPointF(56, -4.22604),
        QPointF(56.1, -4.16306),
        QPointF(56.2, -4.08742),
        QPointF(56.3, -3.99294),
        QPointF(56.4, -3.88331),
        QPointF(56.5, -3.7698),
        QPointF(56.6, -3.66489),
        QPointF(56.7, -3.57548),
        QPointF(56.8, -3.49976),
        QPointF(56.9, -3.42935),
        QPointF(57, -3.35535),
        QPointF(57.1, -3.27427),
        QPointF(57.2, -3.19014),
        QPointF(57.3, -3.11152),
        QPointF(57.4, -3.04528),
        QPointF(57.5, -2.99126),
        QPointF(57.6, -2.94121),
        QPointF(57.7, -2.88292),
        QPointF(57.8, -2.80719),
        QPointF(57.9, -2.71335),
        QPointF(58, -2.61009),
        QPointF(58.1, -2.51068),
        QPointF(58.2, -2.42545),
        QPointF(58.3, -2.35569),
        QPointF(58.4, -2.29275),
        QPointF(58.5, -2.22298),
        QPointF(58.6, -2.13572),
        QPointF(58.7, -2.0298),
        QPointF(58.8, -1.91473),
        QPointF(58.9, -1.8058),
        QPointF(59, -1.71593),
        QPointF(59.1, -1.64872),
        QPointF(59.2, -1.59646),
        QPointF(59.3, -1.54416),
        QPointF(59.4, -1.47729),
        QPointF(59.5, -1.38911),
        QPointF(59.6, -1.2837),
        QPointF(59.7, -1.17306),
        QPointF(59.8, -1.07022),
        QPointF(59.9, -0.982087),
        QPointF(60, -0.90628),
        QPointF(60.1, -0.833415),
        QPointF(60.2, -0.753313),
        QPointF(60.3, -0.661358),
        QPointF(60.4, -0.561467),
        QPointF(60.5, -0.464219),
        QPointF(60.6, -0.381412),
        QPointF(60.7, -0.32007),
        QPointF(60.8, -0.279004),
        QPointF(60.9, -0.249549),
        QPointF(61, -0.219843),
        QPointF(61.1, -0.180206),
        QPointF(61.2, -0.126684),
        QPointF(61.3, -0.0610495),
        QPointF(61.4, 0.0122647),
        QPointF(61.5, 0.089976),
        QPointF(61.6, 0.171904),
        QPointF(61.7, 0.259895),
        QPointF(61.8, 0.354755),
        QPointF(61.9, 0.453692),
        QPointF(62, 0.550448),
        QPointF(62.1, 0.638432),
        QPointF(62.2, 0.714988),
        QPointF(62.3, 0.783902),
        QPointF(62.4, 0.854186),
        QPointF(62.5, 0.935392),
        QPointF(62.6, 1.03194),
        QPointF(62.7, 1.13979),
        QPointF(62.8, 1.24777),
        QPointF(62.9, 1.34335),
        QPointF(63, 1.42016),
        QPointF(63.1, 1.48304),
        QPointF(63.2, 1.54734),
        QPointF(63.3, 1.63216),
        QPointF(63.4, 1.7507),
        QPointF(63.5, 1.90281),
        QPointF(63.6, 2.07392),
        QPointF(63.7, 2.24115),
        QPointF(63.8, 2.38346),
        QPointF(63.9, 2.49082),
        QPointF(64, 2.56791),
        QPointF(64.1, 2.63075),
        QPointF(64.2, 2.69833),
        QPointF(64.3, 2.78355),
        QPointF(64.4, 2.88811),
        QPointF(64.5, 3.00367),
        QPointF(64.6, 3.11814),
        QPointF(64.7, 3.2233),
        QPointF(64.8, 3.3192),
        QPointF(64.9, 3.41342),
        QPointF(65, 3.51605),
        QPointF(65.1, 3.63382),
        QPointF(65.2, 3.76666),
        QPointF(65.3, 3.90819),
        QPointF(65.4, 4.04934),
        QPointF(65.5, 4.18262),
        QPointF(65.6, 4.30492),
        QPointF(65.7, 4.41789),
        QPointF(65.8, 4.52632),
        QPointF(65.9, 4.63605),
        QPointF(66, 4.75246),
        QPointF(66.1, 4.88004),
        QPointF(66.2, 5.02244),
        QPointF(66.3, 5.18224),
        QPointF(66.4, 5.36027),
        QPointF(66.5, 5.55458),
        QPointF(66.6, 5.76032),
        QPointF(66.7, 5.97098),
        QPointF(66.8, 6.18079),
        QPointF(66.9, 6.38714),
        QPointF(67, 6.59137),
        QPointF(67.1, 6.79754),
        QPointF(67.2, 7.00965),
        QPointF(67.3, 7.2289),
        QPointF(67.4, 7.45228),
        QPointF(67.5, 7.67318),
        QPointF(67.6, 7.88382),
        QPointF(67.7, 8.07842),
        QPointF(67.8, 8.25607),
        QPointF(67.9, 8.42184),
        QPointF(68, 8.5855),
        QPointF(68.1, 8.75765),
        QPointF(68.2, 8.94451),
        QPointF(68.3, 9.14369),
        QPointF(68.4, 9.34297),
        QPointF(68.5, 9.52354),
        QPointF(68.6, 9.66678),
        QPointF(68.7, 9.76191),
        QPointF(68.8, 9.81113),
        QPointF(68.9, 9.82934),
        QPointF(69, 9.83843),
        QPointF(69.1, 9.85815),
        QPointF(69.2, 9.89807),
        QPointF(69.3, 9.95422),
        QPointF(69.4, 10.012),
        QPointF(69.5, 10.0537),
        QPointF(69.6, 10.0671),
        QPointF(69.7, 10.0498),
        QPointF(69.8, 10.0093),
        QPointF(69.9, 9.95728),
        QPointF(70, 9.90365),
        QPointF(70.1, 9.85206),
        QPointF(70.2, 9.80018),
        QPointF(70.3, 9.74311),
        QPointF(70.4, 9.67759),
        QPointF(70.5, 9.60429),
        QPointF(70.6, 9.52691),
        QPointF(70.7, 9.44913),
        QPointF(70.8, 9.3719),
        QPointF(70.9, 9.29308),
        QPointF(71, 9.21009),
        QPointF(71.1, 9.12368),
        QPointF(71.2, 9.04023),
        QPointF(71.3, 8.97036),
        QPointF(71.4, 8.92379),
        QPointF(71.5, 8.90314),
        QPointF(71.6, 8.9001),
        QPointF(71.7, 8.89686),
        QPointF(71.8, 8.87289),
        QPointF(71.9, 8.81426),
        QPointF(72, 8.72087),
        QPointF(72.1, 8.60779),
        QPointF(72.2, 8.49948),
        QPointF(72.3, 8.41938),
        QPointF(72.4, 8.37964),
        QPointF(72.5, 8.37583),
        QPointF(72.6, 8.38889),
        QPointF(72.7, 8.39352),
        QPointF(72.8, 8.36923),
        QPointF(72.9, 8.30923),
        QPointF(73, 8.2235),
        QPointF(73.1, 8.13484),
        QPointF(73.2, 8.0697),
        QPointF(73.3, 8.04783),
        QPointF(73.4, 8.07508),
        QPointF(73.5, 8.1418),
        QPointF(73.6, 8.22705),
        QPointF(73.7, 8.30621),
        QPointF(73.8, 8.35898),
        QPointF(73.9, 8.37502),
        QPointF(74, 8.35585),
        QPointF(74.1, 8.31302),
        QPointF(74.2, 8.26362),
        QPointF(74.3, 8.22496),
        QPointF(74.4, 8.20991),
        QPointF(74.5, 8.22388),
        QPointF(74.6, 8.2639),
        QPointF(74.7, 8.31982),
        QPointF(74.8, 8.37742),
        QPointF(74.9, 8.42288),
        QPointF(75, 8.44724),
        QPointF(75.1, 8.4497),
        QPointF(75.2, 8.43816),
        QPointF(75.3, 8.42672),
        QPointF(75.4, 8.43058),
        QPointF(75.5, 8.46024),
        QPointF(75.6, 8.51725),
        QPointF(75.7, 8.59356),
        QPointF(75.8, 8.67469),
        QPointF(75.9, 8.74538),
        QPointF(76, 8.79528),
        QPointF(76.1, 8.82231),
        QPointF(76.2, 8.83283),
        QPointF(76.3, 8.83867),
        QPointF(76.4, 8.85286),
        QPointF(76.5, 8.88544),
        QPointF(76.6, 8.94108),
        QPointF(76.7, 9.01838),
        QPointF(76.8, 9.11078),
        QPointF(76.9, 9.20782),
        QPointF(77, 9.29671),
        QPointF(77.1, 9.36448),
        QPointF(77.2, 9.40103),
        QPointF(77.3, 9.40273),
        QPointF(77.4, 9.37544),
        QPointF(77.5, 9.33464),
        QPointF(77.6, 9.30175),
        QPointF(77.7, 9.29682),
        QPointF(77.8, 9.33026),
        QPointF(77.9, 9.39739),
        QPointF(78, 9.47871),
        QPointF(78.1, 9.54648),
        QPointF(78.2, 9.57538),
        QPointF(78.3, 9.5524),
        QPointF(78.4, 9.4818),
        QPointF(78.5, 9.38218),
        QPointF(78.6, 9.27709),
        QPointF(78.7, 9.18321),
        QPointF(78.8, 9.10214),
        QPointF(78.9, 9.0201),
        QPointF(79, 8.91591),
        QPointF(79.1, 8.77372),
        QPointF(79.2, 8.59425),
        QPointF(79.3, 8.39956),
        QPointF(79.4, 8.19341),
        QPointF(79.5, 7.99792),
        QPointF(79.6, 7.83),
        QPointF(79.7, 7.69499),
        QPointF(79.8, 7.58623),
        QPointF(79.9, 7.48978),
        QPointF(80, 7.39136),
        QPointF(80.1, 7.28203),
        QPointF(80.2, 7.16031),
        QPointF(80.3, 7.03045),
        QPointF(80.4, 6.89842),
        QPointF(80.5, 6.76817),
        QPointF(80.6, 6.64012),
    };

    QVector<QPointF> hex = {
        QPointF(40.66, -15.1904),
        QPointF(40.76, -15.9599),
        QPointF(40.86, -16.652),
        QPointF(40.96, -17.2601),
        QPointF(41.06, -17.8107),
        QPointF(41.16, -18.3435),
        QPointF(41.26, -18.8889),
        QPointF(41.36, -19.4548),
        QPointF(41.46, -20.0295),
        QPointF(41.56, -20.5953),
        QPointF(41.66, -21.1441),
        QPointF(41.76, -21.6833),
        QPointF(41.86, -22.2311),
        QPointF(41.96, -22.8028),
        QPointF(42.06, -23.2101),
        QPointF(42.16, -23.5285),
        QPointF(42.26, -23.795),
        QPointF(42.36, -24.0242),
        QPointF(42.46, -24.2234),
        QPointF(42.56, -24.3998),
        QPointF(42.66, -24.5574),
        QPointF(42.76, -24.6896),
        QPointF(42.86, -24.7776),
        QPointF(42.96, -24.7984),
        QPointF(43.06, -24.7412),
        QPointF(43.16, -24.6188),
        QPointF(43.26, -24.4663),
        QPointF(43.36, -24.3244),
        QPointF(43.46, -24.2204),
        QPointF(43.56, -24.1577),
        QPointF(43.66, -24.1195),
        QPointF(43.76, -24.0827),
        QPointF(43.86, -24.0319),
        QPointF(43.96, -23.9664),
        QPointF(44.06, -23.8965),
        QPointF(44.16, -23.8338),
        QPointF(44.26, -23.7822),
        QPointF(44.36, -23.7356),
        QPointF(44.46, -23.684),
        QPointF(44.56, -23.6227),
        QPointF(44.66, -23.5582),
        QPointF(44.76, -23.5055),
        QPointF(44.86, -23.4774),
        QPointF(44.96, -23.4713),
        QPointF(45.06, -23.4646),
        QPointF(45.16, -23.4207),
        QPointF(45.26, -23.307),
        QPointF(45.36, -23.1139),
        QPointF(45.46, -22.8642),
        QPointF(45.56, -22.6074),
        QPointF(45.66, -22.3992),
        QPointF(45.76, -22.2765),
        QPointF(45.86, -22.2412),
        QPointF(45.96, -22.2602),
        QPointF(46.06, -22.2833),
        QPointF(46.16, -22.2684),
        QPointF(46.26, -22.2012),
        QPointF(46.36, -22.1001),
        QPointF(46.46, -22.0025),
        QPointF(46.56, -21.9417),
        QPointF(46.66, -21.9258),
        QPointF(46.76, -21.9302),
        QPointF(46.86, -21.9068),
        QPointF(46.96, -21.8066),
        QPointF(47.06, -21.6039),
        QPointF(47.16, -21.3124),
        QPointF(47.26, -20.9828),
        QPointF(47.36, -20.6846),
        QPointF(47.46, -20.4789),
        QPointF(47.56, -20.3934),
        QPointF(47.66, -20.4121),
        QPointF(47.76, -20.4814),
        QPointF(47.86, -20.5327),
        QPointF(47.96, -20.5099),
        QPointF(48.06, -20.3919),
        QPointF(48.16, -20.1994),
        QPointF(48.26, -19.9847),
        QPointF(48.36, -19.8067),
        QPointF(48.46, -19.7037),
        QPointF(48.56, -19.6746),
        QPointF(48.66, -19.6801),
        QPointF(48.76, -19.6612),
        QPointF(48.86, -19.568),
        QPointF(48.96, -19.3846),
        QPointF(49.06, -19.1383),
        QPointF(49.16, -18.8885),
        QPointF(49.26, -18.7037),
        QPointF(49.36, -18.6338),
        QPointF(49.46, -18.6911),
        QPointF(49.56, -18.8462),
        QPointF(49.66, -19.0371),
        QPointF(49.76, -19.1893),
        QPointF(49.86, -19.2395),
        QPointF(49.96, -19.1544),
        QPointF(50.06, -18.9401),
        QPointF(50.16, -18.6396),
        QPointF(50.26, -18.3182),
        QPointF(50.36, -18.0434),
        QPointF(50.46, -17.8625),
        QPointF(50.56, -17.7863),
        QPointF(50.66, -17.7856),
        QPointF(50.76, -17.8006),
        QPointF(50.86, -17.764),
        QPointF(50.96, -17.6291),
        QPointF(51.06, -17.3915),
        QPointF(51.16, -17.0947),
        QPointF(51.26, -16.8159),
        QPointF(51.36, -16.6351),
        QPointF(51.46, -16.6004),
        QPointF(51.56, -16.7058),
        QPointF(51.66, -16.8913),
        QPointF(51.76, -17.0677),
        QPointF(51.86, -17.1529),
        QPointF(51.96, -17.104),
        QPointF(52.06, -16.9311),
        QPointF(52.16, -16.6869),
        QPointF(52.26, -16.4411),
        QPointF(52.36, -16.2494),
        QPointF(52.46, -16.134),
        QPointF(52.56, -16.0795),
        QPointF(52.66, -16.0464),
        QPointF(52.76, -15.9909),
        QPointF(52.86, -15.8835),
        QPointF(52.96, -15.7174),
        QPointF(53.06, -15.5075),
        QPointF(53.16, -15.2824),
        QPointF(53.26, -15.0754),
        QPointF(53.36, -14.9165),
        QPointF(53.46, -14.8263),
        QPointF(53.56, -14.8101),
        QPointF(53.66, -14.8525),
        QPointF(53.76, -14.9159),
        QPointF(53.86, -14.9467),
        QPointF(53.96, -14.8916),
        QPointF(54.06, -14.7165),
        QPointF(54.16, -14.4225),
        QPointF(54.26, -14.047),
        QPointF(54.36, -13.6534),
        QPointF(54.46, -13.3104),
        QPointF(54.56, -13.0721),
        QPointF(54.66, -12.9645),
        QPointF(54.76, -12.9805),
        QPointF(54.86, -13.0857),
        QPointF(54.96, -13.2309),
        QPointF(55.06, -13.3677),
        QPointF(55.16, -13.4627),
        QPointF(55.26, -13.5049),
        QPointF(55.36, -13.505),
        QPointF(55.46, -13.4865),
        QPointF(55.56, -13.4709),
        QPointF(55.66, -13.4661),
        QPointF(55.76, -13.4608),
        QPointF(55.86, -13.4313),
        QPointF(55.96, -13.356),
        QPointF(56.06, -13.2299),
        QPointF(56.16, -13.0704),
        QPointF(56.26, -12.9104),
        QPointF(56.36, -12.783),
        QPointF(56.46, -12.7048),
        QPointF(56.56, -12.6693),
        QPointF(56.66, -12.6509),
        QPointF(56.76, -12.6194),
        QPointF(56.86, -12.5544),
        QPointF(56.96, -12.453),
        QPointF(57.06, -12.3271),
        QPointF(57.16, -12.1933),
        QPointF(57.26, -12.0634),
        QPointF(57.36, -11.9404),
        QPointF(57.46, -11.8213),
        QPointF(57.56, -11.7037),
        QPointF(57.66, -11.5901),
        QPointF(57.76, -11.4869),
        QPointF(57.86, -11.3987),
        QPointF(57.96, -11.3237),
        QPointF(58.06, -11.2519),
        QPointF(58.16, -11.1704),
        QPointF(58.26, -11.0705),
        QPointF(58.36, -10.9538),
        QPointF(58.46, -10.8325),
        QPointF(58.56, -10.725),
        QPointF(58.66, -10.6482),
        QPointF(58.76, -10.6097),
        QPointF(58.86, -10.603),
        QPointF(58.96, -10.6096),
        QPointF(59.06, -10.6056),
        QPointF(59.16, -10.5733),
        QPointF(59.26, -10.5118),
        QPointF(59.36, -10.4408),
        QPointF(59.46, -10.3939),
        QPointF(59.56, -10.4015),
        QPointF(59.66, -10.4733),
        QPointF(59.76, -10.588),
        QPointF(59.86, -10.6989),
        QPointF(59.96, -10.7534),
        QPointF(60.06, -10.7166),
        QPointF(60.16, -10.5883),
        QPointF(60.26, -10.4045),
        QPointF(60.36, -10.2216),
        QPointF(60.46, -10.0926),
        QPointF(60.56, -10.045),
        QPointF(60.66, -10.0713),
        QPointF(60.76, -10.1357),
        QPointF(60.86, -10.1912),
        QPointF(60.96, -10.1997),
        QPointF(61.06, -10.1448),
        QPointF(61.16, -10.0342),
        QPointF(61.26, -9.89284),
        QPointF(61.36, -9.75252),
        QPointF(61.46, -9.64125),
        QPointF(61.56, -9.57594),
        QPointF(61.66, -9.55831),
        QPointF(61.76, -9.57391),
        QPointF(61.86, -9.59492),
        QPointF(61.96, -9.58753),
        QPointF(62.06, -9.52343),
        QPointF(62.16, -9.39111),
        QPointF(62.26, -9.20138),
        QPointF(62.36, -8.9836),
        QPointF(62.46, -8.77415),
        QPointF(62.56, -8.60317),
        QPointF(62.66, -8.48521),
        QPointF(62.76, -8.41683),
        QPointF(62.86, -8.38045),
        QPointF(62.96, -8.35209),
        QPointF(63.06, -8.31025),
        QPointF(63.16, -8.24295),
        QPointF(63.26, -8.15035),
        QPointF(63.36, -8.04173),
        QPointF(63.46, -7.92847),
        QPointF(63.56, -7.81648),
        QPointF(63.66, -7.70187),
        QPointF(63.76, -7.57178),
        QPointF(63.86, -7.41003),
        QPointF(63.96, -7.20505),
        QPointF(64.06, -6.95676),
        QPointF(64.16, -6.6786),
        QPointF(64.26, -6.39289),
        QPointF(64.36, -6.12078),
        QPointF(64.46, -5.87137),
        QPointF(64.56, -5.6362),
        QPointF(64.66, -5.39272),
        QPointF(64.76, -5.11587),
        QPointF(64.86, -4.79132),
        QPointF(64.96, -4.42285),
        QPointF(65.06, -4.02904),
        QPointF(65.16, -3.631),
        QPointF(65.26, -3.23823),
        QPointF(65.36, -2.84114),
        QPointF(65.46, -2.41482),
        QPointF(65.56, -1.93182),
        QPointF(65.66, -1.37712),
        QPointF(65.76, -0.757315),
        QPointF(65.86, -0.0993245),
        QPointF(65.96, 0.560907),
        QPointF(66.06, 1.19436),
        QPointF(66.16, 1.7919),
        QPointF(66.26, 2.36777),
        QPointF(66.36, 2.95196),
        QPointF(66.46, 3.57525),
        QPointF(66.56, 4.25422),
        QPointF(66.66, 4.98319),
        QPointF(66.76, 5.73587),
        QPointF(66.86, 6.47527),
        QPointF(66.96, 7.16743),
        QPointF(67.06, 7.79357),
        QPointF(67.16, 8.3567),
        QPointF(67.26, 8.8803),
        QPointF(67.36, 9.39987),
        QPointF(67.46, 9.95013),
        QPointF(67.56, 10.5526),
        QPointF(67.66, 11.2072),
        QPointF(67.76, 11.8916),
        QPointF(67.86, 12.5671),
        QPointF(67.96, 13.1903),
        QPointF(68.06, 13.7274),
        QPointF(68.16, 14.1647),
        QPointF(68.26, 14.513),
        QPointF(68.36, 14.8018),
        QPointF(68.46, 15.0662),
        QPointF(68.56, 15.3312),
        QPointF(68.66, 15.5987),
        QPointF(68.76, 15.8447),
        QPointF(68.86, 16.0271),
        QPointF(68.96, 16.1017),
        QPointF(69.06, 16.0414),
        QPointF(69.16, 15.8495),
        QPointF(69.26, 15.5627),
        QPointF(69.36, 15.2406),
        QPointF(69.46, 14.9461),
        QPointF(69.56, 14.722),
        QPointF(69.66, 14.574),
        QPointF(69.76, 14.4672),
        QPointF(69.86, 14.3377),
        QPointF(69.96, 14.1159),
        QPointF(70.06, 13.7533),
        QPointF(70.16, 13.2412),
        QPointF(70.26, 12.6142),
        QPointF(70.36, 11.937),
        QPointF(70.46, 11.2796),
        QPointF(70.56, 10.6905),
        QPointF(70.66, 10.1811),
        QPointF(70.76, 9.72485),
        QPointF(70.86, 9.27406),
        QPointF(70.96, 8.78326),
        QPointF(71.06, 8.23019),
        QPointF(71.16, 7.62457),
        QPointF(71.26, 7.00239),
        QPointF(71.36, 6.4098),
        QPointF(71.46, 5.88469),
        QPointF(71.56, 5.44358),
        QPointF(71.66, 5.07838),
        QPointF(71.76, 4.76255),
        QPointF(71.86, 4.46289),
        QPointF(71.96, 4.15138),
        QPointF(72.06, 3.81289),
        QPointF(72.16, 3.44695),
        QPointF(72.26, 3.06472),
        QPointF(72.36, 2.68364),
        QPointF(72.46, 2.32198),
        QPointF(72.56, 1.99454),
        QPointF(72.66, 1.70965),
        QPointF(72.76, 1.46741),
        QPointF(72.86, 1.25921),
        QPointF(72.96, 1.0694),
        QPointF(73.06, 0.879278),
        QPointF(73.16, 0.673073),
        QPointF(73.26, 0.443731),
        QPointF(73.36, 0.196143),
        QPointF(73.46, -0.0539679),
        QPointF(73.56, -0.285394),
        QPointF(73.66, -0.479051),
        QPointF(73.76, -0.624861),
        QPointF(73.86, -0.725185),
        QPointF(73.96, -0.793508),
        QPointF(74.06, -0.848999),
        QPointF(74.16, -0.909295),
        QPointF(74.26, -0.984533),
        QPointF(74.36, -1.075),
        QPointF(74.46, -1.17295),
        QPointF(74.56, -1.26739),
        QPointF(74.66, -1.34922),
        QPointF(74.76, -1.41473),
        QPointF(74.86, -1.46614),
        QPointF(74.96, -1.50951),
        QPointF(75.06, -1.55137),
        QPointF(75.16, -1.59579),
        QPointF(75.26, -1.64313),
        QPointF(75.36, -1.69058),
        QPointF(75.46, -1.73378),
        QPointF(75.56, -1.76845),
        QPointF(75.66, -1.79122),
        QPointF(75.76, -1.79989),
        QPointF(75.86, -1.79349),
        QPointF(75.96, -1.77271),
        QPointF(76.06, -1.74053),
        QPointF(76.16, -1.70263),
        QPointF(76.26, -1.66694),
        QPointF(76.36, -1.64173),
        QPointF(76.46, -1.63286),
        QPointF(76.56, -1.64144),
        QPointF(76.66, -1.66301),
        QPointF(76.76, -1.68922),
        QPointF(76.86, -1.71092),
        QPointF(76.96, -1.72142),
        QPointF(77.06, -1.71813),
        QPointF(77.16, -1.70243),
        QPointF(77.26, -1.67811),
        QPointF(77.36, -1.64956),
        QPointF(77.46, -1.62054),
        QPointF(77.56, -1.5937),
        QPointF(77.66, -1.57041),
        QPointF(77.76, -1.55075),
        QPointF(77.86, -1.53321),
        QPointF(77.96, -1.5148),
        QPointF(78.06, -1.49169),
        QPointF(78.16, -1.46079),
        QPointF(78.26, -1.42181),
        QPointF(78.36, -1.37883),
        QPointF(78.46, -1.33991),
        QPointF(78.56, -1.3141),
        QPointF(78.66, -1.30679),
        QPointF(78.76, -1.31567),
        QPointF(78.86, -1.32987),
        QPointF(78.96, -1.33371),
        QPointF(79.06, -1.31387),
        QPointF(79.16, -1.26704),
        QPointF(79.26, -1.19907),
        QPointF(79.36, -1.12073),
        QPointF(79.46, -1.0468),
        QPointF(79.56, -0.989694),
        QPointF(79.66, -0.954489),
        QPointF(79.76, -0.937526),
        QPointF(79.86, -0.92883),
        QPointF(79.96, -0.916989),
        QPointF(80.06, -0.894222),
        QPointF(80.16, -0.85937),
        QPointF(80.26, -0.817555),
        QPointF(80.36, -0.776861),
        QPointF(80.46, -0.743986),
    };

    QVector<QPointF> rox = {
        QPointF(40.75, -2.37203),
        QPointF(40.85, -2.57071),
        QPointF(40.95, -2.756),
        QPointF(41.05, -2.93702),
        QPointF(41.15, -3.12628),
        QPointF(41.25, -3.33166),
        QPointF(41.35, -3.55149),
        QPointF(41.45, -3.77595),
        QPointF(41.55, -3.9936),
        QPointF(41.65, -4.19908),
        QPointF(41.75, -4.39729),
        QPointF(41.85, -4.60122),
        QPointF(41.95, -4.82444),
        QPointF(42.05, -5.07254),
        QPointF(42.15, -5.24493),
        QPointF(42.25, -5.37089),
        QPointF(42.35, -5.46441),
        QPointF(42.45, -5.53536),
        QPointF(42.55, -5.59697),
        QPointF(42.65, -5.66607),
        QPointF(42.75, -5.75676),
        QPointF(42.85, -5.87283),
        QPointF(42.95, -6.0049),
        QPointF(43.05, -6.13528),
        QPointF(43.15, -6.24796),
        QPointF(43.25, -6.33738),
        QPointF(43.35, -6.41044),
        QPointF(43.45, -6.48113),
        QPointF(43.55, -6.5618),
        QPointF(43.65, -6.65656),
        QPointF(43.75, -6.75989),
        QPointF(43.85, -6.86061),
        QPointF(43.95, -6.94807),
        QPointF(44.05, -7.01737),
        QPointF(44.15, -7.07068),
        QPointF(44.25, -7.11476),
        QPointF(44.35, -7.15696),
        QPointF(44.45, -7.20248),
        QPointF(44.55, -7.2545),
        QPointF(44.65, -7.3157),
        QPointF(44.75, -7.38898),
        QPointF(44.85, -7.47538),
        QPointF(44.95, -7.5703),
        QPointF(45.05, -7.66113),
        QPointF(45.15, -7.72935),
        QPointF(45.25, -7.75793),
        QPointF(45.35, -7.74052),
        QPointF(45.45, -7.6873),
        QPointF(45.55, -7.62308),
        QPointF(45.65, -7.57748),
        QPointF(45.75, -7.57163),
        QPointF(45.85, -7.6084),
        QPointF(45.95, -7.67161),
        QPointF(46.05, -7.73521),
        QPointF(46.15, -7.77765),
        QPointF(46.25, -7.79383),
        QPointF(46.35, -7.79794),
        QPointF(46.45, -7.81552),
        QPointF(46.55, -7.86899),
        QPointF(46.65, -7.96421),
        QPointF(46.75, -8.0854),
        QPointF(46.85, -8.20116),
        QPointF(46.95, -8.27874),
        QPointF(47.05, -8.29933),
        QPointF(47.15, -8.26713),
        QPointF(47.25, -8.208),
        QPointF(47.35, -8.15853),
        QPointF(47.45, -8.15068),
        QPointF(47.55, -8.19896),
        QPointF(47.65, -8.29549),
        QPointF(47.75, -8.41455),
        QPointF(47.85, -8.52434),
        QPointF(47.95, -8.60027),
        QPointF(48.05, -8.63428),
        QPointF(48.15, -8.63636),
        QPointF(48.25, -8.6281),
        QPointF(48.35, -8.63164),
        QPointF(48.45, -8.65919),
        QPointF(48.55, -8.70802),
        QPointF(48.65, -8.76297),
        QPointF(48.75, -8.80482),
        QPointF(48.85, -8.82033),
        QPointF(48.95, -8.80866),
        QPointF(49.05, -8.78141),
        QPointF(49.15, -8.75653),
        QPointF(49.25, -8.74934),
        QPointF(49.35, -8.76559),
        QPointF(49.45, -8.79986),
        QPointF(49.55, -8.84006),
        QPointF(49.65, -8.87509),
        QPointF(49.75, -8.90119),
        QPointF(49.85, -8.92314),
        QPointF(49.95, -8.95001),
        QPointF(50.05, -8.98869),
        QPointF(50.15, -9.03984),
        QPointF(50.25, -9.09868),
        QPointF(50.35, -9.1597),
        QPointF(50.45, -9.22115),
        QPointF(50.55, -9.28567),
        QPointF(50.65, -9.35616),
        QPointF(50.75, -9.42933),
        QPointF(50.85, -9.49186),
        QPointF(50.95, -9.52308),
        QPointF(51.05, -9.50467),
        QPointF(51.15, -9.4332),
        QPointF(51.25, -9.32815),
        QPointF(51.35, -9.22912),
        QPointF(51.45, -9.18128),
        QPointF(51.55, -9.21581),
        QPointF(51.65, -9.33567),
        QPointF(51.75, -9.51481),
        QPointF(51.85, -9.71132),
        QPointF(51.95, -9.88674),
        QPointF(52.05, -10.021),
        QPointF(52.15, -10.1152),
        QPointF(52.25, -10.1836),
        QPointF(52.35, -10.2392),
        QPointF(52.45, -10.2833),
        QPointF(52.55, -10.3044),
        QPointF(52.65, -10.2838),
        QPointF(52.75, -10.2073),
        QPointF(52.85, -10.0741),
        QPointF(52.95, -9.90077),
        QPointF(53.05, -9.71827),
        QPointF(53.15, -9.56374),
        QPointF(53.25, -9.47075),
        QPointF(53.35, -9.46055),
        QPointF(53.45, -9.5362),
        QPointF(53.55, -9.68041),
        QPointF(53.65, -9.85794),
        QPointF(53.75, -10.0237),
        QPointF(53.85, -10.1364),
        QPointF(53.95, -10.1743),
        QPointF(54.05, -10.1441),
        QPointF(54.15, -10.0794),
        QPointF(54.25, -10.0233),
        QPointF(54.35, -10.007),
        QPointF(54.45, -10.0336),
        QPointF(54.55, -10.0775),
        QPointF(54.65, -10.1),
        QPointF(54.75, -10.0726),
        QPointF(54.85, -9.99455),
        QPointF(54.95, -9.89561),
        QPointF(55.05, -9.82295),
        QPointF(55.15, -9.81991),
        QPointF(55.25, -9.90728),
        QPointF(55.35, -10.0752),
        QPointF(55.45, -10.2876),
        QPointF(55.55, -10.4959),
        QPointF(55.65, -10.656),
        QPointF(55.75, -10.7415),
        QPointF(55.85, -10.7509),
        QPointF(55.95, -10.7062),
        QPointF(56.05, -10.6433),
        QPointF(56.15, -10.5982),
        QPointF(56.25, -10.5934),
        QPointF(56.35, -10.628),
        QPointF(56.45, -10.6776),
        QPointF(56.55, -10.7049),
        QPointF(56.65, -10.6771),
        QPointF(56.75, -10.5836),
        QPointF(56.85, -10.4437),
        QPointF(56.95, -10.3007),
        QPointF(57.05, -10.202),
        QPointF(57.15, -10.1761),
        QPointF(57.25, -10.2181),
        QPointF(57.35, -10.2933),
        QPointF(57.45, -10.3553),
        QPointF(57.55, -10.3709),
        QPointF(57.65, -10.3359),
        QPointF(57.75, -10.2748),
        QPointF(57.85, -10.2246),
        QPointF(57.95, -10.2132),
        QPointF(58.05, -10.2451),
        QPointF(58.15, -10.302),
        QPointF(58.25, -10.3566),
        QPointF(58.35, -10.391),
        QPointF(58.45, -10.409),
        QPointF(58.55, -10.4351),
        QPointF(58.65, -10.5002),
        QPointF(58.75, -10.6221),
        QPointF(58.85, -10.7893),
        QPointF(58.95, -10.9602),
        QPointF(59.05, -11.0774),
        QPointF(59.15, -11.093),
        QPointF(59.25, -10.9931),
        QPointF(59.35, -10.8086),
        QPointF(59.45, -10.6055),
        QPointF(59.55, -10.4593),
        QPointF(59.65, -10.4239),
        QPointF(59.75, -10.5111),
        QPointF(59.85, -10.6879),
        QPointF(59.95, -10.8923),
        QPointF(60.05, -11.0595),
        QPointF(60.15, -11.1455),
        QPointF(60.25, -11.1411),
        QPointF(60.35, -11.0691),
        QPointF(60.45, -10.9697),
        QPointF(60.55, -10.8801),
        QPointF(60.65, -10.8192),
        QPointF(60.75, -10.7825),
        QPointF(60.85, -10.7489),
        QPointF(60.95, -10.6939),
        QPointF(61.05, -10.6027),
        QPointF(61.15, -10.4762),
        QPointF(61.25, -10.33),
        QPointF(61.35, -10.1875),
        QPointF(61.45, -10.0714),
        QPointF(61.55, -9.99786),
        QPointF(61.65, -9.9732),
        QPointF(61.75, -9.99394),
        QPointF(61.85, -10.0486),
        QPointF(61.95, -10.1207),
        QPointF(62.05, -10.1912),
        QPointF(62.15, -10.2406),
        QPointF(62.25, -10.2503),
        QPointF(62.35, -10.205),
        QPointF(62.45, -10.0975),
        QPointF(62.55, -9.93466),
        QPointF(62.65, -9.74129),
        QPointF(62.75, -9.55736),
        QPointF(62.85, -9.42627),
        QPointF(62.95, -9.3789),
        QPointF(63.05, -9.42065),
        QPointF(63.15, -9.52806),
        QPointF(63.25, -9.65676),
        QPointF(63.35, -9.75689),
        QPointF(63.45, -9.78979),
        QPointF(63.55, -9.74022),
        QPointF(63.65, -9.62012),
        QPointF(63.75, -9.46343),
        QPointF(63.85, -9.31371),
        QPointF(63.95, -9.2091),
        QPointF(64.05, -9.16932),
        QPointF(64.15, -9.18898),
        QPointF(64.25, -9.2392),
        QPointF(64.35, -9.27722),
        QPointF(64.45, -9.26138),
        QPointF(64.55, -9.16674),
        QPointF(64.65, -8.99605),
        QPointF(64.75, -8.78135),
        QPointF(64.85, -8.57432),
        QPointF(64.95, -8.42775),
        QPointF(65.05, -8.37445),
        QPointF(65.15, -8.41218),
        QPointF(65.25, -8.50232),
        QPointF(65.35, -8.58414),
        QPointF(65.45, -8.59922),
        QPointF(65.55, -8.51503),
        QPointF(65.65, -8.33689),
        QPointF(65.75, -8.10363),
        QPointF(65.85, -7.86987),
        QPointF(65.95, -7.6835),
        QPointF(66.05, -7.56796),
        QPointF(66.15, -7.51576),
        QPointF(66.25, -7.4949),
        QPointF(66.35, -7.46438),
        QPointF(66.45, -7.39148),
        QPointF(66.55, -7.26361),
        QPointF(66.65, -7.09033),
        QPointF(66.75, -6.89605),
        QPointF(66.85, -6.70768),
        QPointF(66.95, -6.5432),
        QPointF(67.05, -6.40548),
        QPointF(67.15, -6.28338),
        QPointF(67.25, -6.15866),
        QPointF(67.35, -6.01514),
        QPointF(67.45, -5.84602),
        QPointF(67.55, -5.65604),
        QPointF(67.65, -5.45817),
        QPointF(67.75, -5.2668),
        QPointF(67.85, -5.09119),
        QPointF(67.95, -4.93245),
        QPointF(68.05, -4.78519),
        QPointF(68.15, -4.64249),
        QPointF(68.25, -4.50092),
        QPointF(68.35, -4.36276),
        QPointF(68.45, -4.2341),
        QPointF(68.55, -4.12045),
        QPointF(68.65, -4.02288),
        QPointF(68.75, -3.9372),
        QPointF(68.85, -3.85689),
        QPointF(68.95, -3.77753),
        QPointF(69.05, -3.69987),
        QPointF(69.15, -3.62948),
        QPointF(69.25, -3.57336),
        QPointF(69.35, -3.53562),
        QPointF(69.45, -3.51519),
        QPointF(69.55, -3.50699),
        QPointF(69.65, -3.50599),
        QPointF(69.75, -3.51157),
        QPointF(69.85, -3.52909),
        QPointF(69.95, -3.56733),
        QPointF(70.05, -3.63278),
        QPointF(70.15, -3.72425),
        QPointF(70.25, -3.83109),
        QPointF(70.35, -3.93679),
        QPointF(70.45, -4.02618),
        QPointF(70.55, -4.09261),
        QPointF(70.65, -4.14114),
        QPointF(70.75, -4.18569),
        QPointF(70.85, -4.24164),
        QPointF(70.95, -4.31775),
        QPointF(71.05, -4.41175),
        QPointF(71.15, -4.51197),
        QPointF(71.25, -4.60369),
        QPointF(71.35, -4.67683),
        QPointF(71.45, -4.73078),
        QPointF(71.55, -4.77422),
        QPointF(71.65, -4.82037),
        QPointF(71.75, -4.8804),
        QPointF(71.85, -4.95803),
        QPointF(71.95, -5.04769),
        QPointF(72.05, -5.13664),
        QPointF(72.15, -5.20981),
        QPointF(72.25, -5.25533),
        QPointF(72.35, -5.26872),
        QPointF(72.45, -5.25454),
        QPointF(72.55, -5.22515),
        QPointF(72.65, -5.19727),
        QPointF(72.75, -5.1874),
        QPointF(72.85, -5.20748),
        QPointF(72.95, -5.26177),
        QPointF(73.05, -5.34548),
        QPointF(73.15, -5.44557),
        QPointF(73.25, -5.54386),
        QPointF(73.35, -5.62198),
        QPointF(73.45, -5.66704),
        QPointF(73.55, -5.67594),
        QPointF(73.65, -5.6565),
        QPointF(73.75, -5.62454),
        QPointF(73.85, -5.59775),
        QPointF(73.95, -5.58875),
        QPointF(74.05, -5.59997),
        QPointF(74.15, -5.62261),
        QPointF(74.25, -5.64034),
        QPointF(74.35, -5.63653),
        QPointF(74.45, -5.60221),
        QPointF(74.55, -5.54135),
        QPointF(74.65, -5.47062),
        QPointF(74.75, -5.41309),
        QPointF(74.85, -5.38836),
        QPointF(74.95, -5.40339),
        QPointF(75.05, -5.44853),
        QPointF(75.15, -5.50094),
        QPointF(75.25, -5.53375),
        QPointF(75.35, -5.52681),
        QPointF(75.45, -5.47414),
        QPointF(75.55, -5.38504),
        QPointF(75.65, -5.27901),
        QPointF(75.75, -5.17734),
        QPointF(75.85, -5.09548),
        QPointF(75.95, -5.03916),
        QPointF(76.05, -5.0054),
        QPointF(76.15, -4.98654),
        QPointF(76.25, -4.97465),
        QPointF(76.35, -4.96406),
        QPointF(76.45, -4.95167),
        QPointF(76.55, -4.93593),
        QPointF(76.65, -4.91634),
        QPointF(76.75, -4.89406),
        QPointF(76.85, -4.87333),
        QPointF(76.95, -4.86201),
        QPointF(77.05, -4.87),
        QPointF(77.15, -4.90534),
        QPointF(77.25, -4.96947),
        QPointF(77.35, -5.05392),
        QPointF(77.45, -5.14035),
        QPointF(77.55, -5.20467),
        QPointF(77.65, -5.22414),
        QPointF(77.75, -5.18529),
        QPointF(77.85, -5.08952),
        QPointF(77.95, -4.95384),
        QPointF(78.05, -4.80541),
        QPointF(78.15, -4.67195),
        QPointF(78.25, -4.57229),
        QPointF(78.35, -4.51127),
        QPointF(78.45, -4.48073),
        QPointF(78.55, -4.46464),
        QPointF(78.65, -4.44536),
        QPointF(78.75, -4.40864),
        QPointF(78.85, -4.34638),
        QPointF(78.95, -4.25784),
        QPointF(79.05, -4.14987),
        QPointF(79.15, -4.03665),
        QPointF(79.25, -3.93906),
        QPointF(79.35, -3.84966),
        QPointF(79.45, -3.76198),
        QPointF(79.55, -3.66624),
        QPointF(79.65, -3.55176),
        QPointF(79.75, -3.41063),
        QPointF(79.85, -3.24163),
        QPointF(79.95, -3.05285),
        QPointF(80.05, -2.86144),
        QPointF(80.15, -2.68983),
        QPointF(80.25, -2.55881),
        QPointF(80.35, -2.47994),
        QPointF(80.45, -2.45047),
        QPointF(80.55, -2.45389),
    };

    QVector<QPointF> cy5 = {
        QPointF(40.56, -14.0383),
        QPointF(40.66, -14.954),
        QPointF(40.76, -15.8145),
        QPointF(40.86, -16.5803),
        QPointF(40.96, -17.2463),
        QPointF(41.06, -17.8427),
        QPointF(41.16, -18.4195),
        QPointF(41.26, -19.0235),
        QPointF(41.36, -19.679),
        QPointF(41.46, -20.3809),
        QPointF(41.56, -21.1012),
        QPointF(41.66, -21.8063),
        QPointF(41.76, -22.4735),
        QPointF(41.86, -23.1009),
        QPointF(41.96, -23.51),
        QPointF(42.06, -23.7769),
        QPointF(42.16, -23.9662),
        QPointF(42.26, -24.1193),
        QPointF(42.36, -24.2501),
        QPointF(42.46, -24.3508),
        QPointF(42.56, -24.4021),
        QPointF(42.66, -24.384),
        QPointF(42.76, -24.2841),
        QPointF(42.86, -24.1026),
        QPointF(42.96, -23.8563),
        QPointF(43.06, -23.5782),
        QPointF(43.16, -23.3122),
        QPointF(43.26, -23.1009),
        QPointF(43.36, -22.9697),
        QPointF(43.46, -22.9179),
        QPointF(43.56, -22.919),
        QPointF(43.66, -22.9324),
        QPointF(43.76, -22.9198),
        QPointF(43.86, -22.8582),
        QPointF(43.96, -22.747),
        QPointF(44.06, -22.6053),
        QPointF(44.16, -22.4621),
        QPointF(44.26, -22.3445),
        QPointF(44.36, -22.2666),
        QPointF(44.46, -22.2258),
        QPointF(44.56, -22.2051),
        QPointF(44.66, -22.1813),
        QPointF(44.76, -22.1353),
        QPointF(44.86, -22.0594),
        QPointF(44.96, -21.9597),
        QPointF(45.06, -21.8526),
        QPointF(45.16, -21.7563),
        QPointF(45.26, -21.6821),
        QPointF(45.36, -21.63),
        QPointF(45.46, -21.5887),
        QPointF(45.56, -21.5416),
        QPointF(45.66, -21.4751),
        QPointF(45.76, -21.3847),
        QPointF(45.86, -21.2773),
        QPointF(45.96, -21.1673),
        QPointF(46.06, -21.0707),
        QPointF(46.16, -20.9974),
        QPointF(46.26, -20.9478),
        QPointF(46.36, -20.9126),
        QPointF(46.46, -20.8767),
        QPointF(46.56, -20.825),
        QPointF(46.66, -20.7467),
        QPointF(46.76, -20.6389),
        QPointF(46.86, -20.5068),
        QPointF(46.96, -20.3614),
        QPointF(47.06, -20.2162),
        QPointF(47.16, -20.0833),
        QPointF(47.26, -19.971),
        QPointF(47.36, -19.881),
        QPointF(47.46, -19.8097),
        QPointF(47.56, -19.7485),
        QPointF(47.66, -19.6878),
        QPointF(47.76, -19.6189),
        QPointF(47.86, -19.5373),
        QPointF(47.96, -19.4432),
        QPointF(48.06, -19.3405),
        QPointF(48.16, -19.2356),
        QPointF(48.26, -19.1345),
        QPointF(48.36, -19.0415),
        QPointF(48.46, -18.9578),
        QPointF(48.56, -18.8814),
        QPointF(48.66, -18.8077),
        QPointF(48.76, -18.7304),
        QPointF(48.86, -18.6434),
        QPointF(48.96, -18.5431),
        QPointF(49.06, -18.4299),
        QPointF(49.16, -18.3088),
        QPointF(49.26, -18.1884),
        QPointF(49.36, -18.0779),
        QPointF(49.46, -17.9833),
        QPointF(49.56, -17.9041),
        QPointF(49.66, -17.8329),
        QPointF(49.76, -17.7581),
        QPointF(49.86, -17.67),
        QPointF(49.96, -17.5667),
        QPointF(50.06, -17.4572),
        QPointF(50.16, -17.36),
        QPointF(50.26, -17.2949),
        QPointF(50.36, -17.2734),
        QPointF(50.46, -17.2907),
        QPointF(50.56, -17.3234),
        QPointF(50.66, -17.3362),
        QPointF(50.76, -17.2954),
        QPointF(50.86, -17.1844),
        QPointF(50.96, -17.0124),
        QPointF(51.06, -16.8134),
        QPointF(51.16, -16.6332),
        QPointF(51.26, -16.5111),
        QPointF(51.36, -16.4646),
        QPointF(51.46, -16.484),
        QPointF(51.56, -16.538),
        QPointF(51.66, -16.5887),
        QPointF(51.76, -16.6065),
        QPointF(51.86, -16.5805),
        QPointF(51.96, -16.5199),
        QPointF(52.06, -16.4477),
        QPointF(52.16, -16.388),
        QPointF(52.26, -16.3543),
        QPointF(52.36, -16.3415),
        QPointF(52.46, -16.325),
        QPointF(52.56, -16.269),
        QPointF(52.66, -16.1397),
        QPointF(52.76, -15.9205),
        QPointF(52.86, -15.6224),
        QPointF(52.96, -15.284),
        QPointF(53.06, -14.962),
        QPointF(53.16, -14.7112),
        QPointF(53.26, -14.5641),
        QPointF(53.36, -14.5179),
        QPointF(53.46, -14.5349),
        QPointF(53.56, -14.5578),
        QPointF(53.66, -14.5345),
        QPointF(53.76, -14.4388),
        QPointF(53.86, -14.2794),
        QPointF(53.96, -14.0916),
        QPointF(54.06, -13.9168),
        QPointF(54.16, -13.7815),
        QPointF(54.26, -13.6864),
        QPointF(54.36, -13.6097),
        QPointF(54.46, -13.5213),
        QPointF(54.56, -13.4007),
        QPointF(54.66, -13.2478),
        QPointF(54.76, -13.0828),
        QPointF(54.86, -12.9366),
        QPointF(54.96, -12.8359),
        QPointF(55.06, -12.7912),
        QPointF(55.16, -12.7921),
        QPointF(55.26, -12.8111),
        QPointF(55.36, -12.8145),
        QPointF(55.46, -12.7752),
        QPointF(55.56, -12.6819),
        QPointF(55.66, -12.5424),
        QPointF(55.76, -12.3783),
        QPointF(55.86, -12.2151),
        QPointF(55.96, -12.0718),
        QPointF(56.06, -11.9529),
        QPointF(56.16, -11.8487),
        QPointF(56.26, -11.7403),
        QPointF(56.36, -11.6103),
        QPointF(56.46, -11.4517),
        QPointF(56.56, -11.2729),
        QPointF(56.66, -11.0943),
        QPointF(56.76, -10.9395),
        QPointF(56.86, -10.8231),
        QPointF(56.96, -10.7433),
        QPointF(57.06, -10.6809),
        QPointF(57.16, -10.6072),
        QPointF(57.26, -10.496),
        QPointF(57.36, -10.3349),
        QPointF(57.46, -10.1302),
        QPointF(57.56, -9.90505),
        QPointF(57.66, -9.68992),
        QPointF(57.76, -9.51129),
        QPointF(57.86, -9.382),
        QPointF(57.96, -9.29739),
        QPointF(58.06, -9.23819),
        QPointF(58.16, -9.17883),
        QPointF(58.26, -9.09737),
        QPointF(58.36, -8.98311),
        QPointF(58.46, -8.83898),
        QPointF(58.56, -8.67826),
        QPointF(58.66, -8.51767),
        QPointF(58.76, -8.36987),
        QPointF(58.86, -8.23867),
        QPointF(58.96, -8.11836),
        QPointF(59.06, -7.99698),
        QPointF(59.16, -7.86167),
        QPointF(59.26, -7.70386),
        QPointF(59.36, -7.52227),
        QPointF(59.46, -7.32301),
        QPointF(59.56, -7.11707),
        QPointF(59.66, -6.91644),
        QPointF(59.76, -6.73038),
        QPointF(59.86, -6.56283),
        QPointF(59.96, -6.41178),
        QPointF(60.06, -6.27049),
        QPointF(60.16, -6.13029),
        QPointF(60.26, -5.98397),
        QPointF(60.36, -5.82873),
        QPointF(60.46, -5.66725),
        QPointF(60.56, -5.50644),
        QPointF(60.66, -5.35405),
        QPointF(60.76, -5.21448),
        QPointF(60.86, -5.08591),
        QPointF(60.96, -4.96006),
        QPointF(61.06, -4.82518),
        QPointF(61.16, -4.67095),
        QPointF(61.26, -4.49318),
        QPointF(61.36, -4.29615),
        QPointF(61.46, -4.09154),
        QPointF(61.56, -3.89417),
        QPointF(61.66, -3.71638),
        QPointF(61.76, -3.56323),
        QPointF(61.86, -3.43056),
        QPointF(61.96, -3.30678),
        QPointF(62.06, -3.17755),
        QPointF(62.16, -3.03136),
        QPointF(62.26, -2.86364),
        QPointF(62.36, -2.67777),
        QPointF(62.46, -2.48288),
        QPointF(62.56, -2.28953),
        QPointF(62.66, -2.10533),
        QPointF(62.76, -1.9323),
        QPointF(62.86, -1.76683),
        QPointF(62.96, -1.60212),
        QPointF(63.06, -1.43163),
        QPointF(63.16, -1.25195),
        QPointF(63.26, -1.06378),
        QPointF(63.36, -0.870932),
        QPointF(63.46, -0.67809),
        QPointF(63.56, -0.488725),
        QPointF(63.66, -0.304269),
        QPointF(63.76, -0.12472),
        QPointF(63.86, 0.050011),
        QPointF(63.96, 0.219102),
        QPointF(64.06, 0.380967),
        QPointF(64.16, 0.534506),
        QPointF(64.26, 0.680615),
        QPointF(64.36, 0.822803),
        QPointF(64.46, 0.96623),
        QPointF(64.56, 1.11542),
        QPointF(64.66, 1.2718),
        QPointF(64.76, 1.43239),
        QPointF(64.86, 1.59064),
        QPointF(64.96, 1.73901),
        QPointF(65.06, 1.87221),
        QPointF(65.16, 1.98964),
        QPointF(65.26, 2.09574),
        QPointF(65.36, 2.19828),
        QPointF(65.46, 2.30531),
        QPointF(65.56, 2.42205),
        QPointF(65.66, 2.54914),
        QPointF(65.76, 2.68296),
        QPointF(65.86, 2.81768),
        QPointF(65.96, 2.94836),
        QPointF(66.06, 3.07353),
        QPointF(66.16, 3.19611),
        QPointF(66.26, 3.32242),
        QPointF(66.36, 3.4593),
        QPointF(66.46, 3.61081),
        QPointF(66.56, 3.77548),
        QPointF(66.66, 3.94578),
        QPointF(66.76, 4.11009),
        QPointF(66.86, 4.25705),
        QPointF(66.96, 4.38058),
        QPointF(67.06, 4.48329),
        QPointF(67.16, 4.57653),
        QPointF(67.26, 4.67649),
        QPointF(67.36, 4.79825),
        QPointF(67.46, 4.95044),
        QPointF(67.56, 5.13282),
        QPointF(67.66, 5.33759),
        QPointF(67.76, 5.55314),
        QPointF(67.86, 5.76828),
        QPointF(67.96, 5.97508),
        QPointF(68.06, 6.16957),
        QPointF(68.16, 6.35047),
        QPointF(68.26, 6.51736),
        QPointF(68.36, 6.66924),
        QPointF(68.46, 6.80465),
        QPointF(68.56, 6.92306),
        QPointF(68.66, 7.02655),
        QPointF(68.76, 7.12068),
        QPointF(68.86, 7.21377),
        QPointF(68.96, 7.31481),
        QPointF(69.06, 7.43111),
        QPointF(69.16, 7.56648),
        QPointF(69.26, 7.72057),
        QPointF(69.36, 7.8894),
        QPointF(69.46, 8.06648),
        QPointF(69.56, 8.24442),
        QPointF(69.66, 8.41646),
        QPointF(69.76, 8.57767),
        QPointF(69.86, 8.7255),
        QPointF(69.96, 8.85964),
        QPointF(70.06, 8.98161),
        QPointF(70.16, 9.09426),
        QPointF(70.26, 9.20152),
        QPointF(70.36, 9.30797),
        QPointF(70.46, 9.41789),
        QPointF(70.56, 9.53409),
        QPointF(70.66, 9.65682),
        QPointF(70.76, 9.78355),
        QPointF(70.86, 9.90975),
        QPointF(70.96, 10.0303),
        QPointF(71.06, 10.1409),
        QPointF(71.16, 10.2391),
        QPointF(71.26, 10.3247),
        QPointF(71.36, 10.3998),
        QPointF(71.46, 10.4685),
        QPointF(71.56, 10.536),
        QPointF(71.66, 10.6077),
        QPointF(71.76, 10.6879),
        QPointF(71.86, 10.7781),
        QPointF(71.96, 10.876),
        QPointF(72.06, 10.9755),
        QPointF(72.16, 11.0688),
        QPointF(72.26, 11.1496),
        QPointF(72.36, 11.2159),
        QPointF(72.46, 11.2723),
        QPointF(72.56, 11.3281),
        QPointF(72.66, 11.3936),
        QPointF(72.76, 11.4757),
        QPointF(72.86, 11.5741),
        QPointF(72.96, 11.6816),
        QPointF(73.06, 11.7877),
        QPointF(73.16, 11.8835),
        QPointF(73.26, 11.9661),
        QPointF(73.36, 12.0404),
        QPointF(73.46, 12.1171),
        QPointF(73.56, 12.2076),
        QPointF(73.66, 12.3189),
        QPointF(73.76, 12.4498),
        QPointF(73.86, 12.5905),
        QPointF(73.96, 12.7269),
        QPointF(74.06, 12.8457),
        QPointF(74.16, 12.9399),
        QPointF(74.26, 13.0119),
        QPointF(74.36, 13.0719),
        QPointF(74.46, 13.1337),
        QPointF(74.56, 13.2089),
        QPointF(74.66, 13.3016),
        QPointF(74.76, 13.4074),
        QPointF(74.86, 13.5152),
        QPointF(74.96, 13.6129),
        QPointF(75.06, 13.6921),
        QPointF(75.16, 13.7517),
        QPointF(75.26, 13.7972),
        QPointF(75.36, 13.8376),
        QPointF(75.46, 13.8805),
        QPointF(75.56, 13.9294),
        QPointF(75.66, 13.9827),
        QPointF(75.76, 14.0365),
        QPointF(75.86, 14.0876),
        QPointF(75.96, 14.1366),
        QPointF(76.06, 14.188),
        QPointF(76.16, 14.248),
        QPointF(76.26, 14.321),
        QPointF(76.36, 14.4074),
        QPointF(76.46, 14.5027),
        QPointF(76.56, 14.5997),
        QPointF(76.66, 14.6915),
        QPointF(76.76, 14.7748),
        QPointF(76.86, 14.8503),
        QPointF(76.96, 14.9217),
        QPointF(77.06, 14.9927),
        QPointF(77.16, 15.0638),
        QPointF(77.26, 15.131),
        QPointF(77.36, 15.1857),
        QPointF(77.46, 15.2174),
        QPointF(77.56, 15.2171),
        QPointF(77.66, 15.1814),
        QPointF(77.76, 15.1148),
        QPointF(77.86, 15.0295),
        QPointF(77.96, 14.9421),
        QPointF(78.06, 14.8685),
        QPointF(78.16, 14.8198),
        QPointF(78.26, 14.7987),
        QPointF(78.36, 14.7986),
        QPointF(78.46, 14.8038),
        QPointF(78.56, 14.7924),
        QPointF(78.66, 14.7405),
        QPointF(78.76, 14.6294),
        QPointF(78.86, 14.4505),
        QPointF(78.96, 14.2091),
        QPointF(79.06, 13.9231),
        QPointF(79.16, 13.6372),
        QPointF(79.26, 13.3604),
        QPointF(79.36, 13.0952),
        QPointF(79.46, 12.8371),
        QPointF(79.56, 12.5782),
        QPointF(79.66, 12.3124),
        QPointF(79.76, 12.0399),
        QPointF(79.86, 11.7693),
        QPointF(79.96, 11.5147),
        QPointF(80.06, 11.2904),
        QPointF(80.16, 11.1037),
        QPointF(80.26, 10.9506),
        QPointF(80.36, 10.817),
    };
}

PointSeq PeakDetect::LocalPeaks(const QVector<QPointF> &data) const
{
    PointSeq seq = {};
    QVector<QPointF> temp = {};
    for (int i = 1; i < data.size() - 1; ++i) {
        // see decrease
        if (data[i].y() < data[i - 1].y()) {
            if (temp.size()) {
                seq.append(QPair<int, QPointF>(i - 1, temp.last()));
                temp.clear();
            }
            continue;
        }
        // see plateau
        else if (data[i].y() == data[i - 1].y()) {
            if (temp.size())
                temp.append(data[i]);

            continue;

        }
        // see increase
        else {
            temp.clear();
            temp.append(data[i]);
            continue;
        }
    }
    return seq;
}

PeakInfoSeq PeakDetect::LocalPeakInfo(const QVector<QPointF> &data, const PointSeq &peaks) const
{
    PeakInfoSeq seq;
    for (int i = 0; i < peaks.size(); ++i) {
        PeakInfo info;
        int id = peaks[i].first;
        info.peak = peaks[i];
        info.bottom = PeakBottom(data, info.peak);
        info.width = PeakWidth(data, info.peak, info.bottom);
        info.height = PeakHeight(info.peak, info.bottom);
        seq.append(QPair<int, PeakInfo>(id, info));
    }
    return seq;
}

IdPoint PeakDetect::PeakBottom(const QVector<QPointF> &data, const IdPoint &p) const
{
    // suppose point at id is a real peak

    int id = p.first;
    int left = id;
    int right = id;
    QPointF point = p.second;
    // find plateau
    while (true) {
        if (data[left - 1].y() == point.y())
            left--;
        else
            break;
    }
    while (true) {
        if (data[right + 1].y() == point.y())
            right++;
        else
            break;
    }
    if (left == 0 || right == data.size() - 1)
        throw 0;

    // extend both size until boundary
    while (true) {
        if (left - 1 < 0)
            break;
        if (data[left - 1].y() > data[left].y())
            break;

        left--;
    }
    while (true) {
        if (right + 1 == data.size())
            break;
        if (data[right + 1].y() > data[right].y())
            break;

        right++;
    }

    // return
    if (data[left].y() >= data[right].y())
        return IdPoint(left, data[left]);
    else
        return IdPoint(right, data[right]);
}

double PeakDetect::PeakWidth(const QVector<QPointF> &data, const IdPoint &p, const IdPoint &b) const
{
    if (b.first > p.first) {
        // find left
        for (int id = p.first - 1;; id--) {
            if (data[id].y() <= b.second.y()) {
                double x1;
                LineIntersection().SolveX(data[id], data[id + 1], b.second.y(), x1);
                return b.second.x() - x1;
            }
        }
    } else {
        // find right
        for (int id = p.first + 1;; id++) {
            if (data[id].y() <= b.second.y()) {
                double x1;
                LineIntersection().SolveX(data[id], data[id - 1], b.second.y(), x1);
                return x1 - b.second.x();
            }
        }
    }
}

double PeakDetect::PeakHeight(const IdPoint &p, const IdPoint &b) const
{
    return p.second.y() - b.second.y();
}

PeakInfoSeq PeakDetect::FiltPeaks(const PeakInfoSeq &peaks, const PeakFilter &filter) const
{
    //    qDebug() << "filter params w h r" << filter.min_width << filter.min_height << filter.min_ratio;
    PeakInfoSeq seq;
    QMap<double, QPair<int, PeakInfo>> exclude_height_map;
    for (const auto &p : peaks) {
        //        qDebug() << "filtered point" << p.second.width << p.second.height << p.second.height / p.second.width;
        if (p.second.width >= filter.min_width&&
                p.second.height >= filter.min_height&&
                p.second.height / p.second.width >= filter.min_ratio) {
            seq.append(p);
        }
        else {
            if (filter.min_count==0)
                continue;
            else
                exclude_height_map.insert(p.second.height,p);
            //            if (exclude_height_map.size()==filter.min_count)
            //                exclude_height_map.remove(exclude_height_map.firstKey());
            //            exclude_height_map.insert(p.second.height,p);
        }
    }

    //force to min count
    //    qDebug()<<"meet size"<<seq.size();
    int meet_count=seq.size();
    auto it=exclude_height_map.end()-1; //find from largest
    for (int i=0;i<filter.min_count-meet_count;++i)
    {
        seq.append(it.value());
        it--;
    }

    //    qDebug()<<"force size"<<seq.size();

    return seq;
}

void PeakInfo::DebugOutput() const
{
    qDebug() << "peak w h v r" << width << height << peak.second.y() << height / width << "peak id" << peak.first << peak.second << "bottom id" << bottom.first << bottom.second;
}

PeakInfoSeq PeakDetect::Detect(const QVector<QPointF> &data, const PeakFilter &filter) const
{
    PeakInfoSeq info_seq;
    if (filter.reverse_peak) {
        QVector<QPointF> d;
        for (int i = 0; i < data.size(); ++i) {
            d.append(QPointF(data[i].x(), -data[i].y()));
        }
        PointSeq local_peaks = LocalPeaks(d);
        info_seq = LocalPeakInfo(d, local_peaks);

    } else {
        PointSeq local_peaks = LocalPeaks(data);
        info_seq = LocalPeakInfo(data, local_peaks);
    }
    //    PointSeq local_peaks = LocalPeaks(data);
    //    PeakInfoSeq info_seq = LocalPeakInfo(data, local_peaks);
    //    for (const auto &info : info_seq) {
    //        info.second.DebugOutput();
    //    }
    PeakInfoSeq final = FiltPeaks(info_seq, filter);
    //    qDebug() << "filtered";
    for (const auto &p : final)
        p.second.DebugOutput();
    return final;
}

PeakFilter::PeakFilter(double w, double h, double v, double r, int c, bool rp)
{
    min_width = w;
    min_height = h;
    min_value = v;
    min_ratio = r;
    min_count = c;
    reverse_peak = rp;
}
